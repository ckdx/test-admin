import{u as R,b as T}from"./index.5410f799.js";import{aF as k,aL as U,ah as M,aa as I,aj as P,az as D,aw as x,a7 as a,b2 as L,ak as V,al as g,ai as h,am as i,ax as B,ay as j}from"./vendor.5d21b69b.js";import{f as z,g as G}from"./rule.f3072239.js";import{u as q}from"./useSmsCode.c8101dc6.js";import"./useLoading.38b1a20d.js";import"./useBoolean.c16d084f.js";function H(s=152,o=40){const t=k(),u=k("");function c(n){u.value=n}function e(){!t.value||(u.value=J(t.value,s,o))}return U(()=>{e()}),{domRef:t,imgCode:u,setImgCode:c,getImgCode:e}}function d(s,o){return Math.floor(Math.random()*(o-s)+s)}function b(s,o){const t=d(s,o),u=d(s,o),c=d(s,o);return`rgb(${t},${u},${c})`}function J(s,o,t){let u="";const c="0123456789",e=s.getContext("2d");if(!e)return u;e.fillStyle=b(180,230),e.fillRect(0,0,o,t);for(let n=0;n<4;n+=1){const m=c[d(0,c.length)];u+=m;const f=d(18,41),l=d(-30,30);e.font=`${f}px Simhei`,e.textBaseline="top",e.fillStyle=b(80,150),e.save(),e.translate(30*n+23,15),e.rotate(l*Math.PI/180),e.fillText(m,-15+5,-15),e.restore()}for(let n=0;n<5;n+=1)e.beginPath(),e.moveTo(d(0,o),d(0,t)),e.lineTo(d(0,o),d(0,t)),e.strokeStyle=b(180,230),e.closePath(),e.stroke();for(let n=0;n<41;n+=1)e.beginPath(),e.arc(d(0,o),d(0,t),1,0,2*Math.PI),e.closePath(),e.fillStyle=b(150,200),e.fill();return u}const K=M({props:{code:{default:""}},emits:["update:code"],setup(s,{expose:o,emit:t}){const u=s,{domRef:c,imgCode:e,setImgCode:n,getImgCode:m}=H();return I(()=>u.code,f=>{n(f)}),I(e,f=>{t("update:code",f)}),o({getImgCode:m}),(f,l)=>(P(),D("div",null,[x("canvas",{ref_key:"domRef",ref:c,width:"152",height:"40",class:"cursor-pointer",onClick:l[0]||(l[0]=(..._)=>a(m)&&a(m)(..._))},null,512)]))}}),O={class:"flex-y-center w-full"},Q=x("div",{class:"w-18px"},null,-1),W={class:"pl-8px"},X=B(" \u786E\u5B9A "),Y=B("\u8FD4\u56DE"),ae=M({setup(s){const o=R(),{login:t}=R(),{toLoginModule:u}=T(),{label:c,isCounting:e,loading:n,getSmsCode:m}=q(),f=k(null),l=L({phone:"",code:"",imgCode:""}),_=k(""),w={phone:z.phone,code:z.code,imgCode:G(_)};function N(){m(l.phone)}function $(S){!f.value||(S.preventDefault(),f.value.validate(r=>{if(!r){const{phone:v,code:C}=l;t(v,C,"sms")}}))}return(S,r)=>{const v=h("n-input"),C=h("n-form-item"),y=h("n-button"),A=K,E=h("n-space"),F=h("n-form");return P(),V(F,{ref_key:"formRef",ref:f,model:a(l),rules:w,size:"large","show-label":!1},{default:g(()=>[i(C,{path:"phone"},{default:g(()=>[i(v,{value:a(l).phone,"onUpdate:value":r[0]||(r[0]=p=>a(l).phone=p),placeholder:"\u624B\u673A\u53F7\u7801"},null,8,["value"])]),_:1}),i(C,{path:"code"},{default:g(()=>[x("div",O,[i(v,{value:a(l).code,"onUpdate:value":r[1]||(r[1]=p=>a(l).code=p),placeholder:"\u9A8C\u8BC1\u7801"},null,8,["value"]),Q,i(y,{size:"large",disabled:a(e),loading:a(n),onClick:N},{default:g(()=>[B(j(a(c)),1)]),_:1},8,["disabled","loading"])])]),_:1}),i(C,{path:"imgCode"},{default:g(()=>[i(v,{value:a(l).imgCode,"onUpdate:value":r[2]||(r[2]=p=>a(l).imgCode=p),placeholder:"\u9A8C\u8BC1\u7801,\u70B9\u51FB\u56FE\u7247\u5237\u65B0"},null,8,["value"]),x("div",W,[i(A,{code:_.value,"onUpdate:code":r[3]||(r[3]=p=>_.value=p)},null,8,["code"])])]),_:1}),i(E,{vertical:!0,size:18},{default:g(()=>[i(y,{type:"primary",size:"large",block:!0,round:!0,loading:a(o).loginLoding,onClick:$},{default:g(()=>[X]),_:1},8,["loading"]),i(y,{size:"large",block:!0,round:!0,onClick:r[4]||(r[4]=p=>a(u)("pwd-login"))},{default:g(()=>[Y]),_:1})]),_:1})]),_:1},8,["model"])}}});export{ae as default};
